<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>地圖 | MoData</title>
    <link rel="stylesheet" href="/mo_data/css/styles.css" />
    <link rel="stylesheet" href="/mo_data/css/map.css" />
  </head>

  <body>
    <div id="nav-container"></div>
    <script src="/mo_data/js/componentsLoader.js"></script>

    <div id="content">
      <h1></h1>

      <section id="maparea">
        <h2>一般地圖（可縮放與拖曳）</h2>
        <div class="map-container" id="mapContainer">
          <img
            id="mapImage"
            src="/mo_data/pic/map/map.png"
            alt="遊戲地圖"
            class="map-image"
          />
        </div>
        <p class="map-tip">滑鼠滾輪縮放，拖曳可移動地圖</p>
      </section>
    </div>

    <div id="footer-container"></div>

<script>
  const container = document.querySelector('.map-drag-container');
  const img = container.querySelector('img');

  let isDragging = false;
  let startX, startY, offsetX = 0, offsetY = 0;

  // 初始化圖片位置在中間
  const centerImage = () => {
    const containerRect = container.getBoundingClientRect();
    const imgRect = img.getBoundingClientRect();
    offsetX = (containerRect.width - imgRect.width) / 2;
    offsetY = (containerRect.height - imgRect.height) / 2;
    img.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
  };

  container.addEventListener('mousedown', (e) => {
    isDragging = true;
    container.style.cursor = 'grabbing';
    startX = e.clientX - offsetX;
    startY = e.clientY - offsetY;
  });

  window.addEventListener('mouseup', () => {
    isDragging = false;
    container.style.cursor = 'grab';
  });

  window.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    const containerRect = container.getBoundingClientRect();
    const imgRect = img.getBoundingClientRect();

    offsetX = e.clientX - startX;
    offsetY = e.clientY - startY;

    // 限制邊界：不讓地圖移出容器
    const maxOffsetX = 0;
    const maxOffsetY = 0;
    const minOffsetX = containerRect.width - img.width;
    const minOffsetY = containerRect.height - img.height;

    offsetX = Math.min(maxOffsetX, Math.max(minOffsetX, offsetX));
    offsetY = Math.min(maxOffsetY, Math.max(minOffsetY, offsetY));

    img.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
  });

  // 頁面載入時置中地圖
  window.addEventListener('load', centerImage);
</script>

    <div id="footer-container"></div><!-- 這是頁尾會被載入的位置 -->
  </body>
</html>