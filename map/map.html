<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>地圖 | MoData</title>
    <link rel="stylesheet" href="/mo_data/css/styles.css" />
    <link rel="stylesheet" href="/mo_data/css/map.css" />
  </head>

  <body>
    <div id="nav-container"></div>
    <script src="/mo_data/js/componentsLoader.js"></script>

    <div id="content2">
      <h1></h1>

      <section id="maparea">
        <h2>一般地圖（可縮放與拖曳）</h2>
        <div class="map-container" id="mapContainer">
          <img
            id="mapImage"
            src="/mo_data/pic/map/map.png"
            alt="遊戲地圖"
            class="map-image"
          />
        </div>
        <p class="map-tip">滑鼠滾輪縮放，拖曳可移動地圖</p>
      </section>
    </div>

    <div id="footer-container"></div>

<script>
  const container = document.getElementById('mapContainer');
  const img = container.querySelector('img');

  let isDragging = false;
  let startX, startY;
  let offsetX = 0, offsetY = 0;
  let scale = 1; // 初始縮放比例
  const minScale = 0.5;
  const maxScale = 3;

  // 更新圖片變形樣式
  const updateTransform = () => {
    img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
  };

  // 圖片置中
  const centerImage = () => {
    const containerRect = container.getBoundingClientRect();
    const imgRect = img.getBoundingClientRect();
    offsetX = (containerRect.width - img.width) / 2;
    offsetY = (containerRect.height - img.height) / 2;
    updateTransform();
  };

  // 拖曳功能
  container.addEventListener('mousedown', (e) => {
    isDragging = true;
    container.style.cursor = 'grabbing';
    startX = e.clientX - offsetX;
    startY = e.clientY - offsetY;
  });

  window.addEventListener('mouseup', () => {
    isDragging = false;
    container.style.cursor = 'grab';
  });

  window.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    offsetX = e.clientX - startX;
    offsetY = e.clientY - startY;
    updateTransform();
  });

  // 滾輪縮放功能
  container.addEventListener('wheel', (e) => {
    e.preventDefault(); // 防止頁面捲動

    const rect = container.getBoundingClientRect();
    const mouseX = e.clientX - rect.left;
    const mouseY = e.clientY - rect.top;

    const prevScale = scale;
    const scaleAmount = e.deltaY < 0 ? 1.1 : 0.9;
    scale *= scaleAmount;
    scale = Math.min(maxScale, Math.max(minScale, scale));

    // 調整 offset 使縮放中心對齊滑鼠位置
    offsetX -= (mouseX - offsetX) * (scaleAmount - 1);
    offsetY -= (mouseY - offsetY) * (scaleAmount - 1);

    updateTransform();
  });

  window.addEventListener('load', centerImage);
</script>



    <div id="footer-container"></div><!-- 這是頁尾會被載入的位置 -->
  </body>
</html>